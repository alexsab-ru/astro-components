---
import settings from '@/data/settings.json';
const { site_name, brand, legal_city_where } = settings;
import { TIMER, MARQUEE } from '@/const.js';
import { LAST_DAY, MONTH, MONTH_GENITIVE, YEAR } from '@/js/utils/date';
import Layout from '@/layouts/Layout.astro';
import Banner from '@/components/Banner/Banner.astro';
import PageH1 from '@/components/PageH1/Index.astro';
import Timer from '@/components/Timer/Timer.astro';
import ModelList from '@/components/Model/ModelList.astro';
import LatestPosts from '@/components/LatestPosts/Index.astro';
import Model from '@/components/Model/Model.astro';
import ModelComplectations from '@/components/Model/Complectations.astro';
import Callback from '@/components/Callback.astro';
import Services from '@/components/Services.astro';
import Contacts from '@/components/Contacts.astro';
import Morquee from '@/components/Marquee/Index.astro';
import SectionWithBg from '@/components/SectionWithBg/SectionWithBg.astro';
import modelsData from '@/data/models.json'
const { models } = modelsData;
import salonsData from '@/data/salons.json';
import type { ISalon } from '@/types/ISalon';
const salons = salonsData.filter((salon: ISalon) => !salon?.type || salon?.type.includes('index'));
const modelsWithComplectations = models.filter(m => (m?.complectations !== undefined && m?.complectations.length));
const salonsPhone = salons.map((salon: any) => salon.phone).filter(phone => phone).join(', ');
import SeoText from '@/components/Seo/Index.astro';

import InfoItem from '@/components/Info/Item.astro';
const infoItemClasses = "flex flex-col-reverse items-center justify-end gap-5 transition-all shadow-xl hover:shadow-lg font-medium xl:text-lg text-center p-4";
const infoItems = [
	{title: "Авто под заказ", icon: "carwheel", url: "/pod-zakaz/", iconClasses: "text-accent-500 size-16"},
	{title: "Оригинальные масла", icon: "oil", url: "/owners/oils/", iconClasses: "text-accent-500 size-16"},
	{title: "Тест-драйв", icon: "wheel", url: "/test-drive/", iconClasses: "text-accent-500 size-16"},
	{title: "Запись на сервис", icon: "engine", url: "/service-request/", iconClasses: "text-accent-500 size-16"},
];

import CarsList from '@/components/Cars/List.astro';
import { getCollection } from "astro:content";
const cars = await getCollection("cars");

import reviews from '@/data/reviews.json';
import Reviews from '@/components/Reviews/Index.astro';

---

<Layout title=`Купить ${brand} у официального дилера ${site_name}` description=`Забронируйте свой автомобиль прямо сейчас у официального дилера ${brand} в ${legal_city_where}! ☎️ ${salonsPhone}`>

	<Banner />

	<section class="ptop-[2.7] pbottom-[2.5] bg-accent-500">
		<div class="container">
			<PageH1 h1=`Официальный сайт ${brand} в&nbsp;${legal_city_where}` classes="text-center fz-3 text-white leading-none" />
		</div>
	</section>

	<section>
		<div class="container">
			<div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
				{infoItems.map(item => ( <InfoItem item={item} classes={infoItemClasses} data-title="Получить спецпредложение" data-form_name={`Получить спецпредложение. ${item.title.replace(/<[^>]*>/g, '')}`} /> ))}
			</div>
		</div>
	</section>

	<LatestPosts collectionName="special-offers" title="Специальные предложения" id="specials" class="section bg-gray-100" showAllButton={false} />

	{ true && ( <ModelList id="models" /> )}

	{true && ( <Callback bgUrl="https://cdn.alexsab.ru/konkurenty/honda.webp" title="Запишитесь на тест-драйв!" subtitle="Пройдите тест-драйв на интересном маршруте" formName="Секция. Запись на тест-драйв" id="test-drive" /> )}

	{cars.length > 0 && (
		<section class="section bg-gray-100" id="cars">
			<div class="container">
				<h2 class="text-xl sm:text-4xl mb-8 sm:mb-14">{`Автомобили ${brand} в наличии в ${legal_city_where}`}</h2>

				<CarsList />

			</div>
		</section>
	)}

	<Reviews items={reviews} title="Отзывы наших клиентов" />

	<Services />

	<SeoText mdx="index" />

	<Contacts mapImg="https://cdn.alexsab.ru/maps/map-bg.webp" title="Наши контакты" />

</Layout>
