---
import { getMediaUrl, getPositions } from '@/js/utils/media';
import type { TBanner } from './types'
interface Props{
	banner?: TBanner;
	index?: number;
}
import settings from '@/data/settings.json';
const { site_name, site_description, legal_city_where } = settings;
const {banner, index} = Astro.props;

const desktopImage = getMediaUrl(banner?.imageUrl, banner?.image?.desktop, null);
const tabletImage  = getMediaUrl(banner?.tabletImageUrl, banner?.image?.tablet, null);
const mobileImage  = getMediaUrl(banner?.mobileImageUrl, banner?.image?.mobile, null);

const { mobilePositionClass, tabletPositionClass, desktopPositionClass } = getPositions(banner);
---
<picture>
	{mobileImage && <source media="(min-width: 1024px)" srcset={desktopImage} />}
	{tabletImage && <source media="(min-width: 768px)" srcset={tabletImage} />}
	<img
		src={mobileImage || desktopImage}
		class={`absolute inset-0 h-full w-full object-cover ${mobilePositionClass} ${tabletPositionClass} ${desktopPositionClass}`}
		{...banner?.title ? {alt: banner.title.replace(/<[^>]*>/g, '')} : {alt: `${site_name} ${site_description} Ð² ${legal_city_where}`} }
		{...index === 0 ? {fetchpriority: 'high'} : {}}
		loading="lazy"
	/>
</picture>